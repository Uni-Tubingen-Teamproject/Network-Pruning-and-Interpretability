JobId=422163 JobName=name
   UserId=wzz745(4834) GroupId=wichmann(4014) MCS_label=N/A
   Priority=78289 Nice=0 Account=wichmann QOS=normal
   JobState=RUNNING Reason=None Dependency=(null)
   Requeue=1 Restarts=0 BatchFlag=1 Reboot=0 ExitCode=0:0
   RunTime=00:00:01 TimeLimit=3-00:00:00 TimeMin=N/A
   SubmitTime=2024-06-16T23:44:58 EligibleTime=2024-06-16T23:44:58
   AccrueTime=2024-06-16T23:44:59
   StartTime=2024-06-16T23:44:59 EndTime=2024-06-19T23:44:59 Deadline=N/A
   PreemptEligibleTime=2024-06-16T23:45:59 PreemptTime=None
   SuspendTime=None SecsPreSuspend=0 LastSchedEval=2024-06-16T23:44:59 Scheduler=Main
   Partition=2080-galvani AllocNode:Sid=galvani-slurmctl:526643
   ReqNodeList=(null) ExcNodeList=(null)
   NodeList=galvani-cn106
   BatchHost=galvani-cn106
   NumNodes=1 NumCPUs=8 NumTasks=1 CPUs/Task=8 ReqB:S:C:T=0:0:*:*
   ReqTRES=cpu=8,mem=40G,node=1,billing=2,gres/gpu=1
   AllocTRES=cpu=8,mem=40G,node=1,billing=2,gres/gpu=1,gres/gpu:rtx2080ti=1
   Socks/Node=* NtasksPerN:B:S:C=0:0:*:* CoreSpec=*
   MinCPUsNode=8 MinMemoryNode=40G MinTmpDiskNode=0
   Features=(null) DelayBoot=00:00:00
   OverSubscribe=OK Contiguous=0 Licenses=(null) Network=(null)
   Command=/mnt/qb/home/wichmann/wzz745/Network-Pruning-and-Interpretability/ffcv.sh
   WorkDir=/mnt/qb/home/wichmann/wzz745/Network-Pruning-and-Interpretability
   StdErr=/mnt/qb/home/wichmann/wzz745/Network-Pruning-and-Interpretability/slurm-422163.out
   StdIn=/dev/null
   StdOut=/mnt/qb/home/wichmann/wzz745/Network-Pruning-and-Interpretability/slurm-422163.out
   Power=
   TresPerNode=gres:gpu:1
   MailUser=jonathan.vonrad@gmail.com MailType=BEGIN,END,FAIL
   

/usr/local/lib/python3.10/dist-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: The TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.
  warnings.warn(problem)
Using cache found in /home/wichmann/wzz745/.cache/torch/hub/pytorch_vision_v0.10.0
/usr/local/lib/python3.10/dist-packages/torchvision/models/googlenet.py:341: UserWarning: auxiliary heads in the pretrained googlenet model are NOT pretrained, so make sure to train them
  warnings.warn(
Train loader created in 12.99129843711853 seconds
Train loader created in 0.270704984664917 seconds
Training for 50 epochs with learning rate 0.01 and optimizer <class 'torch.optim.sgd.SGD'> and scheduler <class 'torch.optim.lr_scheduler.ExponentialLR'>

########## Global Unstructured L1 Pruning Iteratively ##########

Accuracy before: 0.17646
Non-zero params before Pruning: 5718464, Total params: 5718464
Relative Pruning Rate: 0.4
Relative Pruning Rate:  0.4
Absolute Pruning Rate:  0.4
Actual Pruning Rate: 0.44231335547447703
Accuracy:  0.16704
Epoch [1/50], Training Loss: 637.2620286212624, Learning Rate: 0.009000000000000001, Validation Accuracy: 0.54088
Epoch [2/50], Training Loss: 540.6876299093267, Learning Rate: 0.008100000000000001, Validation Accuracy: 0.55926
Epoch [3/50], Training Loss: 507.35116280479406, Learning Rate: 0.007290000000000001, Validation Accuracy: 0.56548
Epoch [4/50], Training Loss: 488.50513967056116, Learning Rate: 0.006561000000000002, Validation Accuracy: 0.57928
Epoch [5/50], Training Loss: 475.195264883553, Learning Rate: 0.005904900000000002, Validation Accuracy: 0.58674
Epoch [6/50], Training Loss: 465.5259388651044, Learning Rate: 0.005314410000000002, Validation Accuracy: 0.60044
Epoch [7/50], Training Loss: 457.4378430933156, Learning Rate: 0.004782969000000002, Validation Accuracy: 0.61738
Epoch [8/50], Training Loss: 450.61187479181336, Learning Rate: 0.004304672100000002, Validation Accuracy: 0.61336
Epoch [9/50], Training Loss: 446.06700501835945, Learning Rate: 0.003874204890000002, Validation Accuracy: 0.62712
Epoch [10/50], Training Loss: 440.0945894544519, Learning Rate: 0.003486784401000002, Validation Accuracy: 0.62566
Epoch [11/50], Training Loss: 436.02123923124947, Learning Rate: 0.003138105960900002, Validation Accuracy: 0.6383
Epoch [12/50], Training Loss: 432.5875842113192, Learning Rate: 0.0028242953648100018, Validation Accuracy: 0.6371
Epoch [13/50], Training Loss: 429.42695955049146, Learning Rate: 0.0025418658283290017, Validation Accuracy: 0.65502
Epoch [14/50], Training Loss: 425.7475404155303, Learning Rate: 0.0022876792454961017, Validation Accuracy: 0.6495
Epoch [15/50], Training Loss: 423.6486481441605, Learning Rate: 0.0020589113209464917, Validation Accuracy: 0.65988
Epoch [16/50], Training Loss: 420.3806992865357, Learning Rate: 0.0018530201888518425, Validation Accuracy: 0.66544
Epoch [17/50], Training Loss: 418.1868862182971, Learning Rate: 0.0016677181699666583, Validation Accuracy: 0.66766
Epoch [18/50], Training Loss: 415.6019997803978, Learning Rate: 0.0015009463529699924, Validation Accuracy: 0.67444
Epoch [19/50], Training Loss: 413.4934783334891, Learning Rate: 0.0013508517176729932, Validation Accuracy: 0.683
Epoch [20/50], Training Loss: 411.98204102879674, Learning Rate: 0.001215766545905694, Validation Accuracy: 0.68398
Epoch [21/50], Training Loss: 409.7838809146475, Learning Rate: 0.0010941898913151245, Validation Accuracy: 0.68816
Epoch [22/50], Training Loss: 408.18395100903325, Learning Rate: 0.0009847709021836122, Validation Accuracy: 0.69078
Epoch [23/50], Training Loss: 407.2211095280361, Learning Rate: 0.0008862938119652509, Validation Accuracy: 0.69202
Epoch [24/50], Training Loss: 405.64489124704755, Learning Rate: 0.0007976644307687258, Validation Accuracy: 0.69388
Epoch [25/50], Training Loss: 404.3125922082723, Learning Rate: 0.0007178979876918532, Validation Accuracy: 0.69924
Epoch [26/50], Training Loss: 403.02188430498, Learning Rate: 0.0006461081889226679, Validation Accuracy: 0.70026
Epoch [27/50], Training Loss: 401.70582005979776, Learning Rate: 0.0005814973700304011, Validation Accuracy: 0.7027
Epoch [28/50], Training Loss: 401.05080915457336, Learning Rate: 0.0005233476330273611, Validation Accuracy: 0.70404
Epoch [29/50], Training Loss: 400.0294162438864, Learning Rate: 0.000471012869724625, Validation Accuracy: 0.70794
Epoch [30/50], Training Loss: 398.97713616278065, Learning Rate: 0.0004239115827521625, Validation Accuracy: 0.7092
Epoch [31/50], Training Loss: 398.3610880822494, Learning Rate: 0.00038152042447694626, Validation Accuracy: 0.7083
Epoch [32/50], Training Loss: 397.56264413907365, Learning Rate: 0.00034336838202925164, Validation Accuracy: 0.71154
Epoch [33/50], Training Loss: 396.84637813699607, Learning Rate: 0.0003090315438263265, Validation Accuracy: 0.71312
Epoch [34/50], Training Loss: 396.51165969365366, Learning Rate: 0.00027812838944369386, Validation Accuracy: 0.71358
Epoch [35/50], Training Loss: 395.42419695199123, Learning Rate: 0.0002503155504993245, Validation Accuracy: 0.71382
Epoch [36/50], Training Loss: 395.2931182278966, Learning Rate: 0.00022528399544939206, Validation Accuracy: 0.71288
Epoch [37/50], Training Loss: 394.922947710098, Learning Rate: 0.00020275559590445286, Validation Accuracy: 0.71566
Epoch [38/50], Training Loss: 394.3318259507605, Learning Rate: 0.00018248003631400757, Validation Accuracy: 0.71698
Epoch [39/50], Training Loss: 393.64492420688566, Learning Rate: 0.00016423203268260683, Validation Accuracy: 0.71834
Epoch [40/50], Training Loss: 393.44692833700645, Learning Rate: 0.00014780882941434616, Validation Accuracy: 0.71632
Epoch [41/50], Training Loss: 392.89482316562066, Learning Rate: 0.00013302794647291155, Validation Accuracy: 0.72016
Epoch [42/50], Training Loss: 392.59725956417054, Learning Rate: 0.00011972515182562039, Validation Accuracy: 0.71772
Epoch [43/50], Training Loss: 392.41577076785677, Learning Rate: 0.00010775263664305835, Validation Accuracy: 0.71962
Epoch [44/50], Training Loss: 392.185051919459, Learning Rate: 9.697737297875251e-05, Validation Accuracy: 0.7182
Epoch [45/50], Training Loss: 391.93117839452304, Learning Rate: 8.727963568087727e-05, Validation Accuracy: 0.71986
Epoch [46/50], Training Loss: 392.0135122865739, Learning Rate: 7.855167211278955e-05, Validation Accuracy: 0.71884
Epoch [47/50], Training Loss: 391.6262418632801, Learning Rate: 7.06965049015106e-05, Validation Accuracy: 0.71798
Epoch [48/50], Training Loss: 391.5321455776471, Learning Rate: 6.362685441135955e-05, Validation Accuracy: 0.71902
Epoch [49/50], Training Loss: 391.30495699927195, Learning Rate: 5.7264168970223595e-05, Validation Accuracy: 0.72016
Epoch [50/50], Training Loss: 391.1692712154764, Learning Rate: 5.153775207320124e-05, Validation Accuracy: 0.72
Accuracy after retraining: 0.72
Relative Pruning Rate: 0.4
Relative Pruning Rate:  0.4
Absolute Pruning Rate:  0.64
Actual Pruning Rate: 0.6019453825362895
Accuracy:  0.69118
Epoch [1/50], Training Loss: 464.89084751701984, Learning Rate: 0.009000000000000001, Validation Accuracy: 0.49396
Epoch [2/50], Training Loss: 454.10402563352164, Learning Rate: 0.008100000000000001, Validation Accuracy: 0.50236
Epoch [3/50], Training Loss: 447.0097828031432, Learning Rate: 0.007290000000000001, Validation Accuracy: 0.55552
Epoch [4/50], Training Loss: 441.9514037433449, Learning Rate: 0.006561000000000002, Validation Accuracy: 0.57064
Epoch [5/50], Training Loss: 437.8040855515193, Learning Rate: 0.005904900000000002, Validation Accuracy: 0.5768
Epoch [6/50], Training Loss: 433.67414200876436, Learning Rate: 0.005314410000000002, Validation Accuracy: 0.58562
Epoch [7/50], Training Loss: 431.0016214959759, Learning Rate: 0.004782969000000002, Validation Accuracy: 0.5972
Epoch [8/50], Training Loss: 427.84341636167585, Learning Rate: 0.004304672100000002, Validation Accuracy: 0.60248
Epoch [9/50], Training Loss: 425.2264061374304, Learning Rate: 0.003874204890000002, Validation Accuracy: 0.61726
Epoch [10/50], Training Loss: 422.40312860271456, Learning Rate: 0.003486784401000002, Validation Accuracy: 0.62458
Epoch [11/50], Training Loss: 420.1110283734141, Learning Rate: 0.003138105960900002, Validation Accuracy: 0.63788
Epoch [12/50], Training Loss: 418.28523851238964, Learning Rate: 0.0028242953648100018, Validation Accuracy: 0.64586
Epoch [13/50], Training Loss: 415.8881527956626, Learning Rate: 0.0025418658283290017, Validation Accuracy: 0.64752
Epoch [14/50], Training Loss: 414.04967508612367, Learning Rate: 0.0022876792454961017, Validation Accuracy: 0.65842
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 422163 ON galvani-cn106 CANCELLED AT 2024-06-18T19:51:39 ***
slurmstepd: error: *** STEP 422163.0 ON galvani-cn106 CANCELLED AT 2024-06-18T19:51:39 ***
